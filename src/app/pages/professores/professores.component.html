<app-sidebar></app-sidebar>
<app-top-bar></app-top-bar>

<main class="content">

  <section class="page-content">
    <h1>Gerenciamento de Professores</h1>

    <!-- Formulário -->
    <section class="form-section">
      <h2><i class="bi bi-plus-lg"></i> Adicionar Novo Professor</h2>

      <form #formProfessor="ngForm" (ngSubmit)="adicionarProfessor(formProfessor)">
        <div class="form-grid">

          <div>
            <label>Nome Completo:</label>
            <input type="text" id="nomeProfessor" name="nomeCompleto" required [(ngModel)]="novoProfessor.nomeCompleto">
          </div>

          <div>
            <label>Email:</label>
            <input type="email" id="emailProfessor" name="email" required [(ngModel)]="novoProfessor.email">
          </div>

          <div>
            <label>Telefone:</label>
            <input type="text" id="telefoneProfessor" name="telefone" placeholder="(xx) xxxxx-xxxx"
              [(ngModel)]="novoProfessor.telefone">
          </div>

          <div>
            <label>Qualificação:</label>
            <input type="text" id="qualificacaoProfessor" name="qualificacao" placeholder="Ex: Doutorado em Matemática"
              [(ngModel)]="novoProfessor.qualificacao">
          </div>

          <div>
            <label>Matéria / Departamento:</label>
            <input type="text" id="materiaProfessor" name="materiaDepartamento"
              placeholder="Ex: Matemática, Linguagens..." [(ngModel)]="novoProfessor.materiaDepartamento">
          </div>

          <div class="checkbox">
            <label>
              <input type="checkbox" id="professorAtivo" name="professorAtivo"
                [(ngModel)]="novoProfessor.professorAtivo">
              Professor Ativo
            </label>
          </div>

        </div>

        <label>Biografia</label>
        <textarea id="biografiaProfessor" name="biografia" placeholder="Escreva uma breve biografia..."
          [(ngModel)]="novoProfessor.biografia"></textarea>

        <div class="form-buttons">
          <button type="reset" class="btn-secondary"
            (click)="formProfessor.resetForm({ professorAtivo: true }); novoProfessor.professorAtivo = true">
            Cancelar
          </button>

          <button type="submit" class="btn-primary" [disabled]="formProfessor.invalid">
            Adicionar Professor
          </button>
        </div>

      </form>
    </section>


    <section class="filter-section">
      <h2>Buscar e Filtrar</h2>
      <div class="filter-grid">

        <div class="search-wrapper">
          <i class="bi bi-search"></i>
          <input type="text" [(ngModel)]="filtroNome" name="filtroNome"
            placeholder="Buscar professor por nome ou email...">
        </div>

        <select [(ngModel)]="filtroMateria" name="filtroMateria">
          <option value="">Todas as Matérias</option>
          <option value="Matemática">Matemática</option>
          <option value="Português">Português</option>
          <option value="Ciências">Ciências</option>
        </select>

      </div>
    </section>


    <section class="table-section">
      <h2>Professores Cadastrados</h2>

      <table id="tabelaProfessores">
        <thead>
          <tr>
            <th>Nome</th>
            <th>Email</th>
            <th>Telefone</th>
            <th>Qualificação</th>
            <th>Matéria / Departamento</th>
            <th>Status</th>
            <th>Ações</th>
          </tr>
        </thead>

        <tbody>
          <tr *ngFor="let professor of professoresFiltrados()">
            <td>{{ professor.nomeCompleto }}</td>
            <td>{{ professor.email }}</td>
            <td>{{ professor.telefone }}</td>
            <td>{{ professor.qualificacao }}</td>
            <td>{{ professor.materiaDepartamento }}</td>

            <td>
              <span class="status" [ngClass]="professor.professorAtivo ? 'ativo' : 'inativo'">
                {{ professor.professorAtivo ? 'Ativo' : 'Inativo' }}
              </span>
            </td>

            <td>
              <button class="view" (click)="abrirBiografia(professor)">
                <i class="bi bi-eye"></i>
              </button>

              <button class="delete" (click)="deletarProfessor(professor.id!)">
                <i class="bi bi-trash"></i>
              </button>
            </td>
          </tr>
        </tbody>
      </table>
    </section>

  </section>

</main>

<!-- MODAL -->
<div class="modal" id="modalBiografia">
  <div class="modal-content">
    <span class="close" (click)="fecharModal()">&times;</span>
    <h3>Biografia do Professor</h3>
    <p>{{ professorSelecionado?.biografia }}</p>
  </div>
</div>